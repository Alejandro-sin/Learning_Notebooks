#????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
#El propósito de este
#
#
#
#
#
#
#
#????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????

#??????????????????????????????????????????????????????????????????????????????????????? GRÁFICOS ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
#Le damos una sola variable, porque la y va la frecuencia.
qplot(orangeec$GDP.PC,
      geom="histogram",
      xlab="Caballos de fuerza" ,
      main ="Carros según caballos de fuerza")

ggplot(orangeecs, aes(x=GDP.PC))+
  #Para creae un intervalor mayor, una barra mas ancha usamos el parámetro binwidth
  geom_histogram(binwidth = 1)+
  labs(x="pib PERCAPITA", y ="Cantidad de paises",title= "PIB percapita en paises latam") +
  #Theme, nos permite modificar nuestro gráfico.
  theme(legend.position ="none")
  theme(panel.background = element_blank(), panel.grid.major = element_blank(),
      panel.grid.minor =element_blank())


#Expresar la msima idea de manera diferente
ggplot()+geom_histogram(data = orangeec,
                        aes(x=GDP.PC),
                        fill ="green",
                        color="black",
                        binwidth = 2000)+
  labs(x="pib PERCAPITA", y ="Cantidad de paises",title= "PIB percapita en paises latam")+
  theme(legend.position ="none")
  theme(panel.background = element_blank(), 
      panel.grid.major = element_blank(),
      panel.grid.minor =element_blank())


#Expresar la distribución el aporte de lA econoMía naranja al PIB
  #Al hacer un histograma del aporte de la economía naranja al pib (Creat.Ind) con binwith de 1, 
  #vemos que hay más países que con la economía naranja aportan.
  
ggplot()+geom_histogram(data = orangeec,
                        aes(x=Creat.Ind...GDP),
                        fill ="green",
                        color="black",
                        binwidth = 1)+
  labs(x="Aporte economía naranja al PIB%", y ="Cantidad de paises",title= "Contribución economía Naranja en paises latam")+
  theme(legend.position ="none")
  theme(panel.background = element_blank(), 
      panel.grid.major = element_blank(),
      panel.grid.minor =element_blank())

#Veamos distribución de frecuencias en cuanto a la penetración ene internet.
ggplot()+geom_histogram(data = orangeec,
                        aes(x=Internet.penetration...population),
                        fill ="blue",
                        color="black",
                        binwidth = 5)+
  labs(x="Penetración internet como % poblaciñon", y ="Cantidad de paises",
       title= "Penetración  de internet en paises latam")+
  theme(legend.position ="none")
  theme(panel.background = element_blank(), 
      panel.grid.major = element_blank(),
      panel.grid.minor =element_blank())


#Percapita por encima de promeido.

economy <- mean(orangeec$GDP.PC)
economy
#pARA AHCER EL CAMBIO DEBEMSO USAR DEPLOYER PACKAGE.


#Funcion pipe %>% De un data set a otro, Mutate  es de dplyr me cambiará una nueva variable
orangeec <-  orangeec %>%
  mutate(Strong_economy = ifelse(GDP.PC < economy, "Economy < Xmean PIB_Per cápita","Economy > Xmean PIB_Per cápita"))



#Aporte economía Narana pro debajo y encima de PIB


ggplot(orangeec, aes(x=Strong_economy,y =Creat.Ind...GDP, fill=Strong_economy))+
  geom_boxplot(alpha=0.4)+
  labs(x="Tipo de país", y ="Aporte economía naranja al pib",
       title= "Aporte economína naranja en PIB por país/latam, alto y bajo PIB percapita.")
theme_classic()


# Si hacemos dos box plot según el tipo de país (Strong_economy) para ver la penetración de internet en la población de sus países, veremos que.
# b NO
#Penetración de internet en  paises LATAM

ggplot(orangeec, aes(x=Strong_economy,y =Internet.penetration...population, fill=Strong_economy))+
  geom_boxplot(alpha=0.4)+
  labs(x="Tipo de país", y ="%Penetración internet",
       title= "Penetración de interernet con alto y bajo PIB percapita.")
theme_classic()



# Países que aportan con su economía naranja y la tasa de desempleo.

ggplot(orangeec, aes(x= GDP.PC,y =Unemployment, fill= Country))+
  geom_boxplot(alpha=0.4)+
  labs(x="Aporte ECN %", y =" Desempleo%",
       title= ".")
theme_classic()

#??????????????????????????????????????????????????????????????????????????????????????? ESTADISTICAS ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
#pairs
pairs(orangeec[,2:6])

#Cor para Orangeec.
cor(orangeec[,2:6])


#En el dataset orangeec, la correlación entre el crecimiento del pib de
#un pais (GDP.Growth.) y el aporte de la economía naranja al pib del país 
#(Creat.Ind.GDP) es de..

growth_aporteECN <- subset(orangeec, select= c(4,6))
cor(growth_aporteECN, use = "complete.obs")

#Segundo intervalo

#Se puede interpretar qie por ejemplo para unemployment e indice
pairs(orangeec[,5:10])
cor(orangeec[,5:10],use = "complete.obs")

#Para relacionar variables o columnas no consecutivas.

fragmentdata <- subset(orangeec,select=c(5,6,10,11,12,13))
fragmentdata
pairs(fragmentdata)
cor(fragmentdata)

#Para eliminar los NA de lso datoas. usamos: use = "complete.obs", como un argumento que le pasamso a la función. 
cor(fragmentdata,use = "complete.obs")

#
plot(orangeec$GDP.Growth..~orangeec$Creat.Ind...GDP)


#??????????????????????????????????????????????????????????????????????????????????????? EDA ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????

#EDA oraange
plot(orangeec$Unemployment ~ orangeec$Education.invest...GDP, xlab= "Inversión educación %PIB" ,
     ylab ="Desempleo",main ="Relación inversión en educación y desempleo")


#Aporte econocmia naranja PerCapita

plot(orangeec$GDP.PC ~ orangeec$Creat.Ind...GDP, 
     xlab= "aporte economia naranaja al PIB" ,
     ylab ="PIB percapita",
     main ="Relación economía naranaja PIB percápita")

#??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????? EXÁMEN ?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????

#Si hacemos dos box plot según el tipo de país (Strong_economy)
#para ver la penetración de internet en la población de sus países, veremos que.
#b NO

str(orangeec)

# plot(orangeec$Strong_economy ~ orangeec$Internet.penetration...population, xlab ="StrongEconomy", 
#     ylab ="Internet Penetration on population", main ="Relación Economia fuerte y penetración en Internet")
